\documentclass{article}
\usepackage[utf8]{inputenc}

\usepackage{graphicx}
\graphicspath{ {./images/} }

\usepackage[
backend=biber,
style=authoryear-comp,
]{biblatex}





\addbibresource{mybibliography.bib} %Imports bibliography file

\title{An agent-based model of the 2020 tipping point in global covid policy response with integrated data assimilation}

\author{Yannick Oswald, Nick Malleson}
\date{August 2022}

\begin{document}

\maketitle

Abstract (will be entirely re-written in the end, that is just what got me into the conference): 
 In spring 2020, during the first global wave of the COVID-19 pandemic, a rapid policy tipping point was observed. Heterogeneous countries introduced homogeneous policy responses, almost universally including full-scale lockdowns. Here we build a data-driven agent-based model of this policy diffusion phenomenon, further elucidating the mechanisms behind. It has been shown that, facing great uncertainty about the COVID-19 virus, countries tended to mimic what other similar countries do â€“ Western democracies, for instance, mimicked other Western democracies. We find that the initial conditions of the system matter, that is, who adopts a policy first? Given the initial conditions of spring 2020, we can reproduce the observed diffusion pattern. Additionally, we integrate data assimilation with the model, meaning, the model is constrained by continuously updated real-world data on policy diffusion and this way yields better predictions. Such data assimilation is rare in agent-based models and even rarer in empirical policy applications and therefore this constitutes a methodological advance over previous work.


\section{Introduction}

Several global challenges hinge on an international coordination of policy. Climate change requires a global fossil fuel phase out \parencite{Shukla2022}. Prevention of the next pandemic requires a cohesive bio-security strategy as well as minimum interference with ecosystems \parencite{Morse2012}. International security requires negotiation and a willingness to resolve conflict by peaceful means instead of resorting to violence \parencite{Bercovitch2009}. Moreover, many of these challenges are immensely time pressing. For instance, climate change policy is fundamentally constrained by a scientifically recommended global carbon budget to keep global warming within 1.5 or 2 degree Celsius. And despite being internationally agreed upon, nations lack implementation of policies that actually comply with the target even though at current emissions the global carbon budget for the 1.5 degree is depleted as early as 2030. In other words, progress in the implementation of policies has been far too slow. \\\\

There has been one recent, yet already historic, instance of international policy coordination that was surprisingly rapid, decisive and homogeneous - the implementation of full-scale lockdowns as a response to the COVID-19 pandemic. There was an initial period of response delay, and in some cases even denial of the crisis, from roughly December 2019 to February 2020, but then in March 2020 nearly every country in the world implemented stringent lockdown measures including closures of public venues and schools, mask wearing duties and mandatory home office. On the first of March 2020 only around 8 \% of countries had implemented such stringent measures but by the end of March 2020 around 90\% \parencite{owidcoronavirus}. \\\\

The pandemic has been scientifically scrutinized from many distinct disciplinary and interdisciplinary viewpoints and data collection expanded almost universally across disciplines and issues related to the pandemic. International and freely accessible virus case trackers emerged as well as most capable national governments swiftly implemented regional and sub-regional case tracking as well (prominent trackers are by ourworldindata.org as well as worldometers.info). Moreover, prompted by the drastic and widely perceived shift in policy response, various policy response trackers originated, some focusing on the stringency of direct virus control mechanisms  others even on the wider fiscal policy landscape as well as state-control mechanisms monitoring things such as democratic freedom \parencite{Daly2020}.\\\\

There are very large amounts of research into the biology of the virus and the epidemiology of COVID-19 and from a social scientific viewpoint, there is plenty of research on the economic effects (CITE) of pandemic policies. The political science and sociology of uniform adoption of the lockdown policies has received less attention. There is one notable exception by \textcite{Sebhatu2020} who specifically investigated the drivers of lockdown adoption and who noted the remarkable degree of homogeneity in lockdown adoption by largely heterogeneous countries. They found that there are some country specific drivers, such as the population density and the degree of authoritarianism in countries, that fostered the adoption of lockdowns. Democracies, according to their results, were generally slower to adopt stringent lockdowns. However, their main result is that none of these drivers, nor the actual covid case numbers in a nation are sufficient explanations for the rapid lockdown adoption in March 2020. Instead, they conclude that this diffusion of policy resembles peer-adoption processes in which countries mimicked other countries to cope with the threat and uncertainty posed by the pandemic. Democracies stand out again because, while slow to come up with their own decisions, they exhibited higher sensitivity to adoption through peer-pressure.\\\\

This analogy and insight suggests an agent-based modelling (ABM) approach to further elucidate the diffusion mechanisms and perhaps generalize them, since social diffusion models are a strength of ABMs. Social networks and product diffusion are easy to model with ABMs, yet yield highly accurate descriptions of real-world diffusion curves (CITE). Diffusion-oriented ABMs have been extensively applied to the spread of the COVID-19 virus itself and the effect of policy interventions on the spread (CITE).
There has not been any agent-based study of the formation of the policies as such, which is a notable gap in the literature. This gap is what we aim to close. We develop an agent-based model of the adoption of full-scale lockdowns in which agents are entire countries specifically zeroing in on March 2020. We initialize the model based on real-world data and basic country properties, for instance metrics for the degree of democracy in a country and their geographic location. Moreover, we integrate this data-driven model with a data-assimilation (DA) approach, meaning we constrain the model by regularly updated observations covering (partially) the state of the real-world. In our case, these new observations include which country has adopted a lockdown already or not and the DA approach we choose is a particle filter since it is well-suited for highly non-linear systems and has been tested on a few ABMs of pedestrian dynamics already. Data-assimilation with a policy focus and country-level ABM is a novel application and suggests that significant tipping points in global policy may be better anticipated in the future by integrating computational models and optimal estimation algorithms.


\section{Background}

\subsection{Policy diffusion across nations}

--- don't forget successful examples such as ozone layer coordination

\subsection{Agent-based models in politics and international relations}

\subsection{Peer-adoption and agent-based diffusion models}

\subsection{Data assimilation}




\section{Model and methods}

\subsection{Model description}

The model is a relatively simple but fully data-driven agent-based model implemented in Python-MESA. The principle idea of the model is that the diffusion of the full-scale lockdown policy across countries can be described independently of the actual COVID-case numbers across countries, at least for the period of interest which is March 2020. The main diffusion mechanism is that countries observe which other countries already have adopted a lockdown, and, if those include countries sufficiently similar to oneself, then countries are likely to adopt a lockdown as well. 
There are 164 agents in the model since for 164 countries we were able to collect sufficiently comprehensive data on the covid policy response as well as country specific variables such as national income and degree of democracy.   \\\\

Similarity between countries is measured along three numerical dimensions: National income, degree of democracy and geographical location. National income is expressed through Gross Domestic Product per capita (in Purchasing Power Parity), degree of democracy through the Democracy index by the Economist Intelligence Unit and geographical location simply through latitude and longitude of a country's capital. The Democracy Index is convenient because of its numerical scale from 0 to 10 (low to high degree of democracy) and also correlates well with other non-numerical scales of democracy (CITE).\\\\

All three dimensions are normalized on the unit interval [0,1] and their averaged sum expresses the total difference between two countries. In formal terms

\[d_{ij} = \frac{1}{3} \biggl( \frac{(x_i - x_j)}{(x_{min} - x_{max})}+ \frac{(y_i - y_j)}{(y_{min} - y_{max})} +\frac{H(z_i,z_y)}{H_{max}} \biggr)  \]

where \(x_i\) is the national income of country \(i\), \(y_i\) the degree of democracy of country \(i\) and \(H\) denotes the haversine-formula for the distance between two points on Earth where \(z_i\) is the location of the capital of country \(i\) in terms of latitude and longitude.  \\\\ 

There is also a global parameter \(p\) which denotes how many other countries, an agent takes into consideration when evaluating its own overall distance to the countries already in lockdown. This \(p\) is around 18 in model runs calibrated to the empirical data hinting at realistic peer group sizes between countries. \\\\ 

Any agent \(i\) computes \(d_{ij}\) for all \(k \in \{j  |  \theta(j) = 1\}\) where \(\theta\) is a binary state function that denotes whether another agent is already in lockdown or not (one denotes "in lockdown", zero denotes "not in lockdown"). Finally agent  \(i\) evaluates the average of the \(p\) countries with the least distance to themselves and if this average undercuts a country-specific threshold \(s_i\), then the agent adopts a lockdown. The condition for lockdown adoption based on social factors is therefore:

\[ \frac{1}{p} \sum_{k=1}^{p} d_{ik} < s_i \quad \textrm{where} \quad  s_i \in [0,1] \]

The threshold \(s_i\) is set based on post-implementation model calibration but also set proportional to the degree of democracy in a country aligning with the empirical results by \textcite{Sebhatu2020} who showed that democratic countries are particularly sensitive to lockdown adoption through social mimicking. \\\\ 

There is also a non-social adoption-mechanism, similarly to classic technology-diffusion models such as the Bass-Diffusion Model (CITE bass model) where this mechanism is called 'broadcast influence'. This non-social mechanism basically represents agents taking initiative on their own independently of their peers and is important to represent early adopters for example. The a-social adoption process is also modelled based on a simple adoption-threshold \(b_i\) which itself is set proportional to the square of the logarithm of population-density as well as the inverse of the degree of democracy (or in other words the anti-democracy). This proportionality captures the relative strength of variables influencing the 'base willingness to adopt' a lockdown in line with what \textcite{Sebhatu2020} determined statistically. Furthermore, we assume that this 'base willingness to adopt' is slightly influenced by the overall number of globally adopting countries. However we model this influence such that this global influence basically stays completely insignificant and only makes a measurable difference when nearly all countries already have adopted, giving a slight push to the laggards. We implement the a-social mechanism via a random draw from a uniform distribution at every time step. In precise terms, the a-social adoption condition then is: 

\[ P(X < b_i) \quad \textrm{where} \quad  X {\sim} U[0,1] \quad \textrm{and} \quad b_i \in [0,1] \]

The threshold  \(b_i\) is set the following way: 

\[ b_i = P^2*\frac{1}{Y_i}* B \quad \textrm{with} \quad b_i \in [0,1]   \]

where B is a global parameter, \(Y_i\) the democracy index of agent \(i\) normalized on the variable-average and P the logarithm of the population density.










\includegraphics[width=10cm, height=8cm]{Model setup.PNG}



\subsection{Particle Filter description}

\subsection{Experimental setups}

\subsubsection{Base run, calibration and validation}

parameters table...parameter calibration so that macro data is matched

\subsubsection{Direct data updates}

explain what this is for. Unrealistic experiment in the sense that perfect data feed-in as well as model is run only along side real-world development but we want to pre-conceive the real-world in advance hence the particle filter is necessary to configure model runs. 

To benchmark the model and to see how the model reacts if 
started all over in between from real-world data so to speak.

It is absolutely necessary also to make this experiment since we need to know whether matching all agent states on a micro level is a reliable predictor of macro accuracy. (should be, but we don't know and this will be the proof)

We already do know that matching the lockdown density (macro parameter) in experiment 1 is not necessarily a reliable predictor of micro accuracy. However,  IF we know that matching the micro level is a reliable predictor of macro accuracy we can then run the particle filter evaluation on the micro accuracy/micro level variables and have secure inference about the macro level as well. 

What data update frequency is necessary to achieve perfect run? 

\subsubsection{Particle filter}

realistic

https://www.overleaf.com/project/6305db70f0d6c20a6c1bd623

\section{Results}

\subsection{Experiment 1: Base run, calibration and validation}

\includegraphics[width=10cm, height=8cm]{fanchart_1_macro_validity.png}


\includegraphics[width=10cm, height=8cm]{fanchart_2_micro_validity.png}


\includegraphics[width=12cm, height=6cm]{Micro_validity_1.png}


\subsection{Experiment 2: Direct data updates}

\subsection{Experiment 3: Particle filter}

\section{Discussion and conclusions}

\subsection{Interpretation and generalizability}


\subsection{From macro- to micro-predictability}

experiment 2 and ideally particle filter strongly improve micro predictability 

\subsection{Outlook}
- model improvements e.g. learning rules for behaviour through AI/NN 
-data assimilation, real-time predictions in politics and economics 



\section{References}

\printbibliography

\end{document}
